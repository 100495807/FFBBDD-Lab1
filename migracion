INSERT INTO producto (id, nombre, coffea, varietal, origen, tostado, cafeina)
SELECT DISTINCT
    product as nombre,
    coffea,
    varietal,
    origin as origen,
    roasting as tostado,
    decaf as cafeina
FROM fsdb.catalogue
WHERE
    id = rownum
    AND product IS NOT NULL
    AND coffea IS NOT NULL
    AND varietal IS NOT NULL
    AND origin IS NOT NULL
    AND roasting IS NOT NULL
    AND decaf IS NOT NULL;



INSERT INTO formato(id, nombre)
    SELECT DISTINCT
        --id
        format as nombre
FROM fsdb.catalogue
WHERE
    nombre is not null;


INSERT INTO cantidad(id, cantidad, magnitud, packaging)
    SELECT DISTINCT
        --id
        TO_NUMBER(REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 2)) AS Cantidad,
        REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 3) AS Magnitud,
        REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 1) AS Packaging
FROM fsdb.catalogue
WHERE
    nombre is not null;


INSERT INTO articulo(idCodigo, pvp, stock, stockMin, stockMax)
    SELECT DISTINCT
        barcode as idCodigo,
        retail_price as pvp,
        cur_stock as stock,
        min_stock as stockMin,
        max_stock as stockMax
        
FROM fsdb.catalogue
WHERE
    barcode IS NOT NULL
    AND retail_price IS NOT NULL
    AND cur_stock IS NOT NULL
    AND min_stock IS NOT NULL
    AND max_stock IS NOT NULL;


INSERT INTO proveedor(id, cif, nombreComercio, correo, telefono, CuentaBanco, DireccionPostal, pais, tiempoMedio, numPedido, persona)
    SELECT DISTINCT
        supplier as nombreComercio,
        prov_taxid as cif,
        prov_bankacc as CuentaBanco,
        prov_address as DireccionPostal,
        prov_country as pais,
        prov_person as persona,
        prov_email as correo,
        prov_mobile as telefono
        
FROM fsdb.catalogue
WHERE
    supplier IS NOT NULL
    AND prov_taxid IS NOT NULL
    AND prov_bankacc IS NOT NULL
    AND prov_address IS NOT NULL
    AND prov_country IS NOT NULL
    AND prov_person IS NOT NULL
    AND prov_email IS NOT NULL
    AND prov_mobile IS NOT NULL;


INSERT INTO proveedorArticulo(coste)
    SELECT DISTINCT
        cost_price as coste
        
FROM fsdb.catalogue
WHERE
    cost_price IS NOT NULL;
    

INSERT INTO producto(nombre, variedad, cafe, origen)
    SELECT DISTINCT
        product as nombre,
        prodtype as variedad,
        coffea as cafe,
        varietal as variedad,
        origin as origen,
        roasting as cafe
        
FROM fsdb.trolley
WHERE
    product IS NOT NULL
    AND prodtype IS NOT NULL
    AND coffea IS NOT NULL
    AND varietal IS NOT NULL
    AND origin IS NOT NULL
    AND roasting IS NOT NULL;


INSERT INTO cantidad(id, cantidad, magnitud, packaging)
    SELECT DISTINCT
        --id
        TO_NUMBER(REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 2)) AS Cantidad,
        REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 3) AS Magnitud,
        REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 1) AS Packaging
FROM fsdb.trolley
WHERE
    nombre is not null;


INSERT INTO articulo(idCodigo)
    SELECT DISTINCT
        barcode as idCodigo
        
FROM fsdb.trolley
WHERE
    barcode IS NOT NULL;


INSERT INTO pedidosProveedor(fecha, hora)
    SELECT DISTINCT
        orderdate as fecha,
        ordertime as hora
        
FROM fsdb.trolley
WHERE
    orderdate IS NOT NULL
    AND ordertime IS NOT NULL;


INSERT INTO cliente(nombre, apellido, apellido2, correo, telf)
    SELECT DISTINCT
        client_name as nombre,
        client_surn1 as apellido,
        client_surn2 as apellido2,
        client_email as correo,
        client_mobile as telf
        
FROM fsdb.trolley
WHERE
    client_name IS NOT NULL
    AND client_surn1 IS NOT NULL
    AND client_surn2 IS NOT NULL
    AND client_email IS NOT NULL
    AND client_mobile IS NOT NULL;


INSERT INTO direcciones(tipoVia, nombreVia, numInmueble, numBloque, escalera, piso, puerta, codigoPostal, ciudad, pais)
    SELECT DISTINCT
        bill_waytype as tipoVia,
        bill_wayname as nombreVia,
        bill_gate as numInmueble,
        bill_block as numBloque,
        bill_stairw as escalera,
        bill_floor as piso,
        bill_door as puerta,
        bill_zip as codigoPostal,
        bill_town as ciudad,
        bill_country as pais,
        dliv_waytype as tipoVia,
        dliv_wayname as nombreVia,
        dliv_gate as numInmueble,
        dliv_block as numBloque,
        dliv_stairw as escalera,
        dliv_floor as piso,
        dliv_door as puerta,
        dliv_zip as codigoPostal,
        dliv_town as ciudad,
        dliv_country as pais
        
        
FROM fsdb.trolley
WHERE
    bill_waytype IS NOT NULL
    AND bill_wayname IS NOT NULL
    AND bill_gate IS NOT NULL
    AND bill_block IS NOT NULL
    AND bill_stairw IS NOT NULL
    AND bill_floor IS NOT NULL
    AND bill_door IS NOT NULL
    AND bill_zip IS NOT NULL
    AND bill_town IS NOT NULL
    AND bill_country IS NOT NULL
    AND dliv_waytype IS NOT NULL
    AND dliv_wayname IS NOT NULL
    AND dliv_gate IS NOT NULL
    AND dliv_block IS NOT NULL
    AND dliv_stairw IS NOT NULL
    AND dliv_floor IS NOT NULL
    AND dliv_door IS NOT NULL
    AND dliv_zip IS NOT NULL
    AND dliv_town IS NOT NULL
    AND dliv_country IS NOT NULL;

