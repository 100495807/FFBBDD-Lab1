INSERT INTO producto (nombre, coffea, varietal, origen, tostado, cafeina)
SELECT DISTINCT
    product as nombre, 
    coffea, 
    varietal, 
    origin as origen,
    roasting as tostado,           --he tenido que modifica en la otra tabla de varchar a char osea como estaba en la antigua  pero creo que no debemos hacer eso
    decaf as cafeina
FROM fsdb.catalogue WHERE
    product IS NOT NULL 
    AND coffea IS NOT NULL 
    AND varietal IS NOT NULL
    AND origin IS NOT NULL  
    AND roasting IS NOT NULL 
    AND decaf IS NOT NULL;

INSERT INTO cantidad(packaging, cantidad, magnitud)
    SELECT DISTINCT
    SUBSTR(packaging, 1, INSTR(packaging, ' ')) AS packaging,
    SUBSTR(packaging, INSTR(packaging, ' ') +1, INSTR(packaging, ' ',1, 2) - INSTR(packaging, ' ')-1) AS cantidad,     
    SUBSTR(packaging, INSTR(packaging, ' ', 1, 2) +1, LENGTH(Packaging) - INSTR(packaging, ' ', 1, 2)-1) AS magnitud
FROM fsdb.catalogue
WHERE
    packaging is not null;


INSERT INTO formatoProducto(idProducto, formato, packaging, cantidad, magnitud)
SELECT DISTINCT
    product as idProducto,
    format as idFormato,
    SUBSTR(packaging, 1, INSTR(packaging, ' ')) AS packaging,
    SUBSTR(packaging, INSTR(packaging, ' ') +1, INSTR(packaging, ' ',1, 2) - INSTR(packaging, ' ')-1) AS cantidad,     
    SUBSTR(packaging, INSTR(packaging, ' ', 1, 2) +1, LENGTH(Packaging) - INSTR(packaging, ' ', 1, 2)-1) AS magnitud
FROM fsdb.catalogue WHERE
    product IS NOT NULL
    AND format IS NOT NULL 
    AND packaging is not null;


INSERT INTO articulo(idCodigo, packaging, cantidad, magnitud, pvp, stock, producto, stockMin, stockMax)
    SELECT DISTINCT
        barcode as idCodigo,
        SUBSTR(packaging, 1, INSTR(packaging, ' ')) AS packaging,
        SUBSTR(packaging, INSTR(packaging, ' ') +1, INSTR(packaging, ' ',1, 2) - INSTR(packaging, ' ')-1) AS cantidad,     
        SUBSTR(packaging, INSTR(packaging, ' ', 1, 2) +1, LENGTH(Packaging) - INSTR(packaging, ' ', 1, 2)-1) AS magnitud,
        retail_price as pvp,
        cur_stock as stock,
        product as producto,
        TO_NUMBER(min_stock) as stockMin,
        TO_NUMBER(max_stock) as stockMax
FROM fsdb.catalogue WHERE
    barcode IS NOT NULL
    AND packaging IS NOT NULL
    AND retail_price IS NOT NULL
    AND cur_stock IS NOT NULL
    AND product IS NOT NULL
    AND min_stock IS NOT NULL
    AND max_stock IS NOT NULL;

--hasta aqui ya

INSERT INTO proveedor(id, cif, nombreComercio, correo, telefono, CuentaBanco, DireccionPostal, pais, tiempoMedio, numPedido, persona)
    SELECT DISTINCT
        supplier as nombreComercio,
        prov_taxid as cif,
        prov_bankacc as CuentaBanco,
        prov_address as DireccionPostal,
        prov_country as pais,
        prov_person as persona,
        prov_email as correo,
        prov_mobile as telefono
        
FROM fsdb.catalogue
WHERE
    supplier IS NOT NULL
    AND prov_taxid IS NOT NULL
    AND prov_bankacc IS NOT NULL
    AND prov_address IS NOT NULL
    AND prov_country IS NOT NULL
    AND prov_person IS NOT NULL
    AND prov_email IS NOT NULL
    AND prov_mobile IS NOT NULL;


INSERT INTO proveedorArticulo(coste)
    SELECT DISTINCT
        cost_price as coste
        
FROM fsdb.catalogue
WHERE
    cost_price IS NOT NULL;
    

INSERT INTO producto(nombre, variedad, cafe, origen)
    SELECT DISTINCT
        product as nombre,
        prodtype as variedad,
        coffea as cafe,
        varietal as variedad,
        origin as origen,
        roasting as cafe
        
FROM fsdb.trolley
WHERE
    product IS NOT NULL
    AND prodtype IS NOT NULL
    AND coffea IS NOT NULL
    AND varietal IS NOT NULL
    AND origin IS NOT NULL
    AND roasting IS NOT NULL;


INSERT INTO cantidad(id, cantidad, magnitud, packaging)
    SELECT DISTINCT
        --id
        TO_NUMBER(REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 2)) AS Cantidad,
        REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 3) AS Magnitud,
        REGEXP_SUBSTR(Packaging, '\(([^,]+), (\d+) ([^\)]+)\)', 1, 1, NULL, 1) AS Packaging
FROM fsdb.trolley
WHERE
    nombre is not null;


INSERT INTO articulo(idCodigo)
    SELECT DISTINCT
        barcode as idCodigo
        
FROM fsdb.trolley
WHERE
    barcode IS NOT NULL;


INSERT INTO pedidosProveedor(fecha, hora)
    SELECT DISTINCT
        orderdate as fecha,
        ordertime as hora
        
FROM fsdb.trolley
WHERE
    orderdate IS NOT NULL
    AND ordertime IS NOT NULL;


INSERT INTO cliente(nombre, apellido, apellido2, correo, telf)
    SELECT DISTINCT
        client_name as nombre,
        client_surn1 as apellido,
        client_surn2 as apellido2,
        client_email as correo,
        client_mobile as telf
        
FROM fsdb.trolley
WHERE
    client_name IS NOT NULL
    AND client_surn1 IS NOT NULL
    AND client_surn2 IS NOT NULL
    AND client_email IS NOT NULL
    AND client_mobile IS NOT NULL;


INSERT INTO direccion(tipoVia, nombreVia, numInmueble, numBloque, escalera, piso, puerta, codigoPostal, ciudad, pais)
    SELECT DISTINCT
        bill_waytype as tipoVia,
        bill_wayname as nombreVia,
        bill_gate as numInmueble,
        bill_block as numBloque,
        bill_stairw as escalera,
        bill_floor as piso,
        bill_door as puerta,
        bill_zip as codigoPostal,
        bill_town as ciudad,
        bill_country as pais,
        dliv_waytype as tipoVia,
        dliv_wayname as nombreVia,
        dliv_gate as numInmueble,
        dliv_block as numBloque,
        dliv_stairw as escalera,
        dliv_floor as piso,
        dliv_door as puerta,
        dliv_zip as codigoPostal,
        dliv_town as ciudad,
        dliv_country as pais
        
        
FROM fsdb.trolley
WHERE
    bill_waytype IS NOT NULL
    AND bill_wayname IS NOT NULL
    AND bill_gate IS NOT NULL
    AND bill_block IS NOT NULL
    AND bill_stairw IS NOT NULL
    AND bill_floor IS NOT NULL
    AND bill_door IS NOT NULL
    AND bill_zip IS NOT NULL
    AND bill_town IS NOT NULL
    AND bill_country IS NOT NULL
    AND dliv_waytype IS NOT NULL
    AND dliv_wayname IS NOT NULL
    AND dliv_gate IS NOT NULL
    AND dliv_block IS NOT NULL
    AND dliv_stairw IS NOT NULL
    AND dliv_floor IS NOT NULL
    AND dliv_door IS NOT NULL
    AND dliv_zip IS NOT NULL
    AND dliv_town IS NOT NULL
    AND dliv_country IS NOT NULL;


INSERT INTO tarjetaCredito(compañia, numTarjeta, titular, caducidadMes, caducidadYear)
    SELECT DISTINCT
        card_company as compañia,
        card_number as numTarjeta,
        card_holder as titular,
        card_expiratn as caducidadMes,
        card_expiratn as caducidadYear
        
FROM fsdb.trolley
WHERE
    card_company IS NOT NULL
    AND card_number IS NOT NULL
    AND card_holder IS NOT NULL
    AND card_expiratn IS NOT NULL;


INSERT INTO descuento(porcentaje)
    SELECT DISTINCT
        discount as porcentaje
        
FROM fsdb.trolley
WHERE
    discount IS NOT NULL;


INSERT INTO registrado(usuario, fechaRegistro, horaRegistro, contrasena)
    SELECT DISTINCT
        username as usuario,
        reg_date as fechaEntrega,
        reg_time as horaRegistro,
        user_passw as contrasena
        
FROM fsdb.trolley
WHERE
    username IS NOT NULL
    AND reg_date IS NOT NULL
    AND reg_time IS NOT NULL
    AND user_passw IS NOT NULL;


INSERT INTO pedidoCliente(tipoPago, fechaPago, horaPago, fechaEntrega, horaEntrega)
    SELECT DISTINCT
        payment_type as tipoPago,
        payment_date as fechaEntrega,
        payment_time as horaPago,
        dliv_date as fechaEntrega,
        dliv_time as horaEntrega
        
FROM fsdb.trolley
WHERE
    payment_type IS NOT NULL
    AND payment_date IS NOT NULL
    AND payment_time IS NOT NULL
    AND dliv_date IS NOT NULL
    AND dliv_time IS NOT NULL;



INSERT INTO pedidoArticuloCliente(cantidad)
    SELECT DISTINCT
        quantity as cantidad
        
FROM fsdb.trolley
WHERE
    quantity IS NOT NULL;


INSERT INTO producto(nombre)
    SELECT DISTINCT
        product as nombre
        
FROM fsdb.posts
WHERE
    product IS NOT NULL;


INSERT INTO articulo(idCodigo)
    SELECT DISTINCT
        barcode as idCodigo
        
FROM fsdb.posts
WHERE
    barcode IS NOT NULL;


INSERT INTO registrado(usuario)
    SELECT DISTINCT
        username as usuario
        
FROM fsdb.posts
WHERE
    username IS NOT NULL;


INSERT INTO review(fecha, hora, titulo, texto, puntuacion, meGusta, refrenda)
    SELECT DISTINCT
        post_date as fecha,
        post_time as hora,
        title as titulo,
        text as texto,
        score as puntuacion,
        likes as meGusta,
        endorsed as refrenda
        
FROM fsdb.posts
WHERE
    post_date IS NOT NULL
    AND post_time IS NOT NULL
    AND title IS NOT NULL
    AND text IS NOT NULL
    AND score IS NOT NULL
    AND likes IS NOT NULL
    AND endorsed IS NOT NULL;